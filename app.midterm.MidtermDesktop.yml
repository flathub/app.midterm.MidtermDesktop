app-id: app.midterm.MidtermDesktop
runtime: org.freedesktop.Sdk
runtime-version: "20.08"
branch: stable
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: "20.08"
command: midterm
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=pulseaudio
  - --share=network
  - --filesystem=host
modules:
  - name: midterm
    buildsystem: simple
    build-commands:
      # Bundle app and dependencies
      - mkdir -p /app/main /app/bin
      # Copy source code
      - cp -ra main/* /app/main/

      - install -Dm644 logo_16x16.png /app/share/icons/hicolor/16x16/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_24x24.png /app/share/icons/hicolor/24x24/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_32x32.png /app/share/icons/hicolor/32x32/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_48x48.png /app/share/icons/hicolor/48x48/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_64x64.png /app/share/icons/hicolor/64x64/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_128x128.png /app/share/icons/hicolor/128x128/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_256x256.png /app/share/icons/hicolor/256x256/apps/app.midterm.MidtermDesktop.png
      - install -Dm644 logo_512x512.png /app/share/icons/hicolor/512x512/apps/app.midterm.MidtermDesktop.png

      - install -Dm644 app.midterm.MidtermDesktop.metainfo.xml /app/share/metainfo
      - install -Dm644 app.midterm.MidtermDesktop.desktop -t /app/share/applications

      # Install app wrapper
      - install -D midterm /app/bin/
    sources:
      - type: archive
        url: https://midterm-desktop-builds.s3.us-east-2.amazonaws.com/Midterm-0.9.2.tar.gz
        sha256: ef7f077e3abdf374d0ac1b809abde7ea0ae5f6249bfbfb170acd41bda36689e0
        dest: main
      - type: file
        path: app.midterm.MidtermDesktop.metainfo.xml
      - type: file
        path: app.midterm.MidtermDesktop.desktop
      # Icons
      - type: file
        path: icons/logo_16x16.png
      - type: file
        path: icons/logo_24x24.png
      - type: file
        path: icons/logo_32x32.png
      - type: file
        path: icons/logo_48x48.png
      - type: file
        path: icons/logo_64x64.png
      - type: file
        path: icons/logo_128x128.png
      - type: file
        path: icons/logo_256x256.png
      - type: file
        path: icons/logo_512x512.png
      # Wrapper to launch the app
      - type: script
        dest-filename: midterm
        commands:
          - exec zypak-wrapper /app/main/midterm "$@"
